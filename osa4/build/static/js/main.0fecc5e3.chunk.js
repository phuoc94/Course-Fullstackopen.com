(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{42:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),u=n(17),c=n.n(u),o=n(2),l=n(1),i=n.n(l),s=n(7),d=n(5),b=n(6),p=n.n(b),m="/api/blogs",f=null,v={getAll:function(){var e=Object(d.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.get(m);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(d.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:f}},e.next=3,p.a.post(m,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return p.a.put("".concat(m,"/").concat(e.id),t).then((function(e){return e.data}))},setToken:function(e){f="bearer ".concat(e)},remove:function(e){var t={headers:{Authorization:f}};return p.a.delete("".concat(m,"/").concat(e.id),t).then((function(e){return e.data}))}},g=n(4),E=n.n(g),h=function(e){var t=e.blog,n=e.setBlogs,u=e.blogs,c=e.user,l=e.notiHandler,b=Object(r.useState)(!1),p=Object(o.a)(b,2),m=p[0],f=p[1],g={paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},E=function(){var e=Object(d.a)(i.a.mark((function e(){var r,a,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=4;break;case 4:return e.prev=4,r=t.id,a=t.likes+1,e.next=9,v.update({id:r},{likes:a});case 9:c=e.sent,n(u.map((function(e){return e.id!==t.id?e:Object(s.a)(Object(s.a)({},e),{},{likes:c.likes})}))),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),console.log("error",e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(d.a)(i.a.mark((function e(){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("remove blog ".concat(t.title))){e.next=12;break}return e.prev=1,r=t.id,e.next=5,v.remove({id:r});case 5:l.current.notiHandler("blog ".concat(t.title," removed"),"success"),n(u.filter((function(e){return e.id!==r}))),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("error",e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();return m?a.a.createElement("div",{className:"blog",style:g},a.a.createElement("p",null,t.title," ",a.a.createElement("button",{className:"button",id:"btn-hide",onClick:function(){return f(!1)}},"hide")),a.a.createElement("p",null,t.url),a.a.createElement("p",null,"likes ",t.likes," ",a.a.createElement("button",{className:"button",id:"btn-like",onClick:E},"like")),a.a.createElement("p",null,t.author),c.username===t.user.username&&a.a.createElement("p",null,a.a.createElement("button",{className:"button",id:"btn-remove",onClick:h},"remove"))):a.a.createElement("div",{className:"blog",style:g},t.title," ",t.author," ",a.a.createElement("button",{className:"button",id:"btn-view",onClick:function(){return f(!0)}},"view"))};h.prototype={blog:E.a.object.isRequired,setBlogs:E.a.func.isRequired,notiHandler:E.a.func.isRequired,blogs:E.a.array.isRequired,user:E.a.object.isRequired};var j=h,k=a.a.forwardRef((function(e,t){var n=Object(r.useState)(null),u=Object(o.a)(n,2),c=u[0],l=u[1],i=function(e,t){l([e,t]),setTimeout((function(){l(null)}),5e3)};if(Object(r.useImperativeHandle)(t,(function(){return{notiHandler:i}})),c){var s=c[0],d=c[1];return"error"===d?a.a.createElement("div",{className:"error"},s):"success"===d?a.a.createElement("div",{className:"success"},s):a.a.createElement("div",null,s)}return null}));k.displayName="Notification";var O=k,w={login:function(){var e=Object(d.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},y=function(e){var t=e.notiHandler,n=e.setUser,u=Object(r.useState)(""),c=Object(o.a)(u,2),l=c[0],s=c[1],b=Object(r.useState)(""),p=Object(o.a)(b,2),m=p[0],f=p[1],g=function(){var e=Object(d.a)(i.a.mark((function e(r){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,w.login({username:l,password:m});case 4:a=e.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(a)),v.setToken(a.token),n(a),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),t.current.notiHandler("wrong username or password","error"),f("");case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("form",{onSubmit:g},a.a.createElement("div",null,"username",a.a.createElement("input",{type:"text",id:"username",value:l,name:"Username",onChange:function(e){var t=e.target;return s(t.value)}})),a.a.createElement("div",null,"password",a.a.createElement("input",{type:"password",id:"password",value:m,name:"Password",onChange:function(e){var t=e.target;return f(t.value)}})),a.a.createElement("button",{id:"login-button",type:"submit"},"login"))};y.prototype={notiHandler:E.a.func.isRequired,setUser:E.a.func.isRequired};var x=y,S=function(e){var t=e.setBlogs,n=e.blogs,u=e.user,c=e.notiHandler,l=e.FormRef,b=Object(r.useState)(""),p=Object(o.a)(b,2),m=p[0],f=p[1],g=Object(r.useState)(""),E=Object(o.a)(g,2),h=E[0],j=E[1],k=Object(r.useState)(""),O=Object(o.a)(k,2),w=O[0],y=O[1],x=function(){var e=Object(d.a)(i.a.mark((function e(r){var a,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.preventDefault(),e.next=5;break;case 5:return e.prev=5,e.next=8,v.create({title:m,author:h,url:w});case 8:a=e.sent,o=Object(s.a)(Object(s.a)({},a),{},{user:{username:u.username}}),t(n.concat(o)),c.current.notiHandler("a new blog ".concat(m," by ").concat(h," added"),"success"),f(""),j(""),y(""),l.current.toggleVisibility(),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(5),c.current.notiHandler("".concat(e.t0),"error");case 21:case"end":return e.stop()}}),e,null,[[5,18]])})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("form",{onSubmit:x},a.a.createElement("div",null,a.a.createElement("h2",null,"Create new blog"),"title:",a.a.createElement("input",{type:"text",value:m,id:"title",name:"title",onChange:function(e){var t=e.target;return f(t.value)}})),a.a.createElement("div",null,"author:",a.a.createElement("input",{type:"text",value:h,id:"author",name:"author",onChange:function(e){var t=e.target;return j(t.value)}})),a.a.createElement("div",null,"url:",a.a.createElement("input",{type:"text",value:w,id:"url",name:"url",onChange:function(e){var t=e.target;return y(t.value)}})),a.a.createElement("button",{id:"create-button",type:"submit"},"create"))};S.prototype={setBlogs:E.a.func.isRequired,notiHandler:E.a.func.isRequired,blogs:E.a.array.isRequired};var H=S,R=a.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),u=Object(o.a)(n,2),c=u[0],l=u[1],i={display:c?"none":""},s={display:c?"":"none"},d=function(){l(!c)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:d}})),a.a.createElement("div",null,a.a.createElement("div",{style:i},a.a.createElement("button",{onClick:d},e.buttonLabel)),a.a.createElement("div",{style:s},e.children,a.a.createElement("button",{onClick:d},"cancel")))}));R.displayName="Togglable";var C=R,N=function(){var e=Object(r.useState)([]),t=Object(o.a)(e,2),n=t[0],u=t[1],c=Object(r.useState)(null),l=Object(o.a)(c,2),i=l[0],s=l[1];Object(r.useEffect)((function(){v.getAll().then((function(e){return u(e.sort((function(e,t){return e.likes<t.likes?1:-1})))}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);s(t),v.setToken(t.token)}}),[]);var d=Object(r.useRef)(),b=Object(r.useRef)();return a.a.createElement("div",null,a.a.createElement("h2",null,"blogs"),a.a.createElement(O,{ref:b}),null===i?a.a.createElement(C,{buttonLabel:"login"},a.a.createElement(x,{setUser:s,notiHandler:b})):a.a.createElement("div",null,a.a.createElement("p",null,i.name," logged in",a.a.createElement("button",{onClick:function(){window.localStorage.removeItem("loggedBlogappUser"),s(null)}},"Logout")),a.a.createElement(C,{buttonLabel:"Create new blog",ref:d},a.a.createElement(H,{setBlogs:u,blogs:n,user:i,notiHandler:b,FormRef:d}))),null!==i&&n.map((function(e){return a.a.createElement(j,{key:e.id,blog:e,setBlogs:u,blogs:n,user:i,notiHandler:b})})))};n(42);c.a.render(a.a.createElement(N,null),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.0fecc5e3.chunk.js.map